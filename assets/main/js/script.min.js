import{preloadImages}from"../../libs/utils.js";let lenis;function customDropdown(){let s=$(".dropdown-custom");s.each(function(){let t=$(this),o=t.find(".dropdown-custom__btn"),r=t.find(".dropdown-custom__menu");var e=t.find(".dropdown-custom__item");let a=t.find(".dropdown-custom__text");function n(o){$(".dropdown-custom__btn").removeClass("active"),s.each(function(){var e=$(this).find(".dropdown-custom__menu"),t=$(this).find(".dropdown-custom__btn");o&&$(this).is(o)||(e.removeClass("dropdown--active"),t.removeClass("--active"))})}o.on("click",function(e){e.stopPropagation(),n(t),r.toggleClass("dropdown--active"),o.toggleClass("--active")}),$(document).on("click",function(){n()}),e.on("click",function(e){e.stopPropagation();e=$(this);let t=a.text();var o=a.find("img").attr("src"),r=e.find("img");a.text(e.text()),r.length?(a.html(e.html()),e.hasClass("language__item")&&(t=`<span>${t}</span>`),e.html(`${o?`<img src="${o}" />`:""} `+t)):e.hasClass("language__item")&&e.text(t),n()})})}function header(){let e=$(".header-hambuger"),t=$(".header-sub-container"),o=$(".header-sub"),r=$(".header-icon-close"),a=$("body");var n=$(".header-sub-empty");e.on("click",function(){e.addClass("active"),o.addClass("active"),a.addClass("overflow-hidden"),setTimeout(function(){t.addClass("active")},100)}),r.on("click",function(){t.removeClass("active"),e.removeClass("active"),setTimeout(function(){r.removeClass("active"),o.removeClass("active"),a.removeClass("overflow-hidden")},300)}),n.on("click",function(){t.removeClass("active"),e.removeClass("active"),setTimeout(function(){r.removeClass("active"),o.removeClass("active"),a.removeClass("overflow-hidden")},300)}),991<=$(window).width()&&r.hover(function(){e.addClass("hovered")},function(){e.removeClass("hovered")})}function effectText(){gsap.registerPlugin(SplitText,ScrollTrigger),document.fonts.ready.then(()=>{document.querySelectorAll(".effect-heading-mask-line").forEach(t=>{gsap.set(t,{opacity:1});let o;SplitText.create(t,{type:"words,lines",linesClass:"line",mask:"lines",onSplit:e=>(t.classList.contains("scroll-trigger")?o=gsap.from(e.lines,{duration:.4,yPercent:100,opacity:0,stagger:.1,ease:"expo.out",scrollTrigger:{trigger:t,start:"top 60%",end:"bottom 60%",toggleActions:"play none none none"}}):(o=gsap.from(e.lines,{duration:.4,yPercent:100,opacity:0,stagger:.1,ease:"expo.out"}),gsap.to(o,{timeScale:.2,onStart:()=>o.play(0)})),o)})}),gsap.utils.toArray(".effect-fade-content").forEach(e=>{gsap.fromTo(e,{"will-change":"opacity, transform",opacity:0,y:20},{scrollTrigger:{trigger:e,start:"top 75%",end:"bottom 75%"},opacity:1,y:0,duration:.3,ease:"sine.out"})}),gsap.utils.toArray(".effect-fade-content-auto").forEach((e,t)=>{gsap.fromTo(e,{"will-change":"opacity, transform",opacity:0,y:20},{opacity:1,y:0,duration:.3,ease:"sine.out",delay:.5})}),document.querySelectorAll(".effect-heading-blur").forEach(e=>{var t=SplitText.create(e,{type:"words, chars",charsClass:"split-char",wordsClass:"split-word"});gsap.fromTo(t.chars,{filter:"blur(10px) ",y:10,willChange:"filter, transform",opacity:0},{ease:"none",filter:"blur(0px)",y:0,stagger:.05,opacity:1,scrollTrigger:{trigger:e.classList.contains("footer-effect-text")?".footer-ovl":e,start:"top 90%"}})})})}function introChess(){if(!(document.querySelectorAll(".section-intro").length<1)){let t=new Lenis,o=(t.on("scroll",()=>ScrollTrigger.update()),e=>{t.raf(1e3*e),requestAnimationFrame(o)}),e=(requestAnimationFrame(o),gsap.registerPlugin(ScrollTrigger,SplitText),document.getElementById("canvas-chess")),s=e.getContext("2d");e.width=window.innerWidth,e.height=window.innerHeight,window.addEventListener("resize",function(){e.width=window.innerWidth,e.height=window.innerHeight,u()});var n=document.querySelector(".section-intro");let r,i=(r=n.classList.contains("home")?e=>`./assets/images/img-chess/chess-${(e+1).toString()}.jpg`:n.classList.contains("about")?e=>`./assets/images/img-about/chess-${(e+1).toString()}.jpg`:e=>`./assets/images/img-chess/chess-${(e+1).toString()}.jpg`,[]),c={frame:0},a=0;for(let t=0;t<74;t++){let e=new Image;e.src=r(t),e.onload=()=>{74===++a&&u()},e.onerror=()=>{console.error("Không tải được hình ảnh: "+e.src)},i[t]=e}gsap.to(c,{frame:73,snap:"frame",ease:"none",scrollTrigger:{scrub:1,trigger:"#canvas-chess",start:"top+=100 bottom",end:"bottom top"},onUpdate:u});var n=document.querySelector(".section-intro-content .tag"),l=document.querySelector(".section-intro-content .h2-heading"),l=new SplitText(l,{type:"words,lines",mask:"lines",linesClass:"line"}),d=gsap.timeline({scrollTrigger:{trigger:"#canvas-chess",start:`top+=${70/74*100-50}% top`,end:`top+=${70/74*100+50}% top`,toggleActions:"play none none reverse"}});function u(){var e,t,o,r,a,n;i[c.frame]&&i[c.frame].complete&&(e=i[c.frame],t=s,o=t.canvas,r=o.width/e.width,a=o.height/e.height,r=Math.max(r,a),a=(o.width-e.width*r)/2,n=(o.height-e.height*r)/2,t.clearRect(0,0,o.width,o.height),t.drawImage(e,0,0,e.width,e.height,a,n,e.width*r,e.height*r))}d.fromTo(n,{opacity:0,y:20},{opacity:1,y:0,duration:.4,ease:"expo.out"}),d.fromTo(l.lines,{opacity:0,yPercent:100},{opacity:1,yPercent:0,duration:.4,stagger:.1,ease:"expo.out"},"-=0.3"),gsap.to(".section-intro",{scrollTrigger:{trigger:".section-intro",start:"top top",end:"bottom top",pin:!0,pinSpacing:!1}})}}function whyChooseUs(){$(".why-choose-us").length<1||(document.querySelectorAll(".why-choose-us .main-section").forEach(a=>{let n=a.querySelector(".list-wrapper"),s=0,i=!1;a.addEventListener("mouseenter",()=>{i=!0}),a.addEventListener("mouseleave",()=>{i=!1,n.style.transform="translateX(0px)"}),a.addEventListener("mousemove",e=>{var t,o,r;e=e,i&&(t=a.offsetWidth,o=n.scrollWidth-t+80,r=a.getBoundingClientRect(),e=e.clientX-r.left,s=t-200<=e?-o:Math.min(0,e/(t-200)*o*-1),s=Math.max(-o,Math.min(0,s)),n.style.transform=`translateX(${s}px)`)})}),0<$(".why-choose-us.page-expertise").length&&ScrollTrigger.create({trigger:".why-choose-us.page-expertise",start:"top 70%",end:"bottom top",onEnter:()=>{document.querySelector(".why-choose-us.page-expertise").classList.add("theme-light"),document.querySelector(".header-menu-container").classList.add("theme-light"),document.querySelector("main").classList.add("theme-light")},onLeaveBack:()=>{document.querySelector(".why-choose-us.page-expertise").classList.remove("theme-light"),document.querySelector(".header-menu-container").classList.remove("theme-light"),document.querySelector("main").classList.remove("theme-light")}}))}function coreValue(){if(!($(".core-value").length<1)){var t=window.innerWidth;let e=t-32;991<t?e=t-160:767<t&&(e=t-80);var o=(t-e)/2/t*100,r=document.querySelector(".core-value .core-value__top").offsetHeight,t=(r-(991<t?r-100:r))/2/r*100;gsap.fromTo(".core-value .image",{clipPath:`inset(${t}% ${o}% ${t}% ${o}%)`},{scrollTrigger:{trigger:".core-value .core-value__top",start:"top 70%",end:"bottom 70%",scrub:1},clipPath:"inset(0% 0% 0% 0%)",duration:.4,ease:"power2.out"}),gsap.fromTo(".core-value .image img",{scale:1.1},{scrollTrigger:{trigger:".core-value .core-value__top",start:"top 70%",end:"bottom 70%",scrub:1},scale:1,duration:.4,ease:"power2.out"}),$("#core-value-text").length<1||((r=gsap.timeline({scrollTrigger:{trigger:"#core-value-text",start:"center center",end:"+=200%",scrub:!0,pin:!0,toggleClass:{targets:".core-value",className:"active"}}})).to("#core-value-text",{scale:1.7,duration:.6,ease:"power2.out"}),r.to("#core-value-text",{xPercent:-300,duration:.5,ease:"none"}))}}function magicCursor(){if(document.querySelector(".magic-cursor")){var r=document.querySelector(".magic-cursor");gsap.set(r,{xPercent:-50,yPercent:-50});let t,o;window.addEventListener("mousemove",e=>{t=e.clientX,o=e.clientY,gsap.to(r,{x:t,y:o,duration:.1})});var a=document.querySelector(".magic-cursor .cursor"),n=document.querySelector(".magic-cursor .cursor .icon");document.querySelector(".magic-cursor .cursor .text-content");document.querySelectorAll(".project-item").forEach(e=>{e.addEventListener("mouseenter",()=>{a.classList.add("show")}),e.addEventListener("mouseleave",()=>{a.classList.remove("show")})}),document.querySelectorAll("[data-cursor='arrow']").forEach(t=>{t.addEventListener("mouseenter",()=>{a.classList.add("show","arrow");var e=t.classList.contains("swiper-button-prev")?180:0;gsap.to(n,{rotate:e,yPercent:-50,xPercent:-50,duration:.3,ease:"power2.out"})}),t.addEventListener("mouseleave",()=>{a.classList.remove("show","arrow"),gsap.to(n,{rotate:0,yPercent:-50,xPercent:-50,duration:.3,ease:"power2.out"})})}),document.querySelectorAll(".client-wrapper").forEach(e=>{e.addEventListener("mouseenter",()=>{a.classList.add("show")}),e.addEventListener("mouseleave",()=>{a.classList.remove("show")})}),document.querySelectorAll(".list-wrapper").forEach(e=>{e.addEventListener("mouseenter",()=>{a.classList.add("show")}),e.addEventListener("mouseleave",()=>{a.classList.remove("show")})})}}function pinSectionBanner(){var e=document.querySelector(".group-intro-banner");let t=document.querySelector(".section-banner-title"),o=!1;e&&t&&gsap.to(e,{scrollTrigger:{trigger:e,pin:!0,pinSpacing:!1,start:"top top",end:"+=500",scrub:!0,onUpdate:e=>{1!==e.progress||o?e.progress<1&&o&&(gsap.to(t,{opacity:1,duration:.5,ease:"power2.out"}),o=!1):(gsap.to(t,{opacity:0,duration:.5,ease:"power2.out"}),o=!0)}}})}function cookieModal(){let t=document.querySelector(".modal-cookies");var e,o;t&&(e=t.querySelector("button[data-button='ACCEPT']"),o=t.querySelector("button[data-button='REJECT']"),e)&&o&&((()=>{var e=localStorage.getItem("cookieConsent");if(e)try{var t=JSON.parse(e);return Date.now()<t.expires}catch(e){}})()?t.classList.remove("open"):t.classList.add("open"),e.addEventListener("click",function(){var e=Date.now()+2592e6;localStorage.setItem("cookieConsent",JSON.stringify({accepted:!0,expires:e})),t.classList.remove("open")}),o.addEventListener("click",function(){t.classList.remove("open")}))}function addThemeLightToHeader(){var e=document.querySelector("body.blog-page-detail"),t=document.querySelector(".header-menu-container");e&&t&&t.classList.add("theme-light")}function loading(){var e,t;$(".loading").length<1||(e=gsap.timeline({onComplete:()=>{$("body").removeClass("overflow-hidden")}}),t=$(".loading"),$("body").addClass("overflow-hidden"),(t.hasClass("out-home")?(gsap.delayedCall(1.5,effectTextBanner),e.to(t.find(".loading-logo"),{opacity:0,y:-60},.5).to(t.find(".loading-wrapper"),{scaleY:0,duration:1.5},1)):(gsap.delayedCall(4.25,effectTextBanner),e.to(t.find(".loading-logo"),{opacity:0,y:-60},.5).to(t.find(".loading-text"),{opacity:1,y:0}).to(t.find(".loading-text"),{opacity:0,y:-60},2).to(t.find(".loading-desc"),{opacity:1,y:0}).to(t.find(".loading-desc"),{opacity:0,y:-60},3.5).to(t.find(".loading-wrapper"),{scaleY:0,duration:1.5},3.75))).to(t,{autoAlpha:0,duration:0}))}function effectTextBanner(){document.querySelectorAll(".effect-heading-mask-line-banner").forEach(t=>{gsap.set(t,{opacity:0});let o;SplitText.create(t,{type:"words,lines",linesClass:"line",mask:"lines",onSplit:e=>(o=gsap.fromTo(e.lines,{yPercent:100,opacity:0},{yPercent:0,opacity:1,duration:.4,stagger:.1,ease:"expo.out"}),gsap.to(o,{timeScale:.2,onStart:()=>o.play(0)}),gsap.to(t,{opacity:1,duration:0,delay:.1}),o)})}),gsap.utils.toArray(".effect-fade-content-banner").forEach(e=>{var t=e.dataset.delay?parseFloat(e.dataset.delay):0;gsap.fromTo(e,{"will-change":"opacity, transform",opacity:0,y:20},{opacity:1,y:0,duration:.3,ease:"sine.out",delay:.5+t})})}function stickyFilter(){$(window).on("scroll",function(){var e=$(".project-filter");e.offset().top-$(window).scrollTop()<=84?(e.addClass("sticky"),$(".header-menu-container").addClass("hide")):(e.removeClass("sticky"),$(".header-menu-container").removeClass("hide"))})}$(window).on("DOMContentLoaded",function(){loading()});let init=()=>{gsap.registerPlugin(ScrollTrigger),header(),pinSectionBanner(),customDropdown(),effectText(),introChess(),whyChooseUs(),coreValue(),magicCursor(),addThemeLightToHeader(),setTimeout(()=>{cookieModal()},1e3),ScrollTrigger.refresh()};preloadImages("img").then(()=>{init()}),$(window).on("beforeunload",function(){$(window).scrollTop(0)});