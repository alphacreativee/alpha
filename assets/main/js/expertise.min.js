import{preloadImages}from"../../libs/utils.js";function animateChessItems(){if($(".banner-expertise").length){var n=document.querySelector(".section-banner.banner-expertise"),i=document.querySelectorAll(".wrapper-chess .chess-item"),n=n?n.getBoundingClientRect().height:0;let t=0;i.forEach(e=>{t+=e.getBoundingClientRect().height});i=n+t-window.innerHeight+200;let e=document.querySelector(".banner-expertise-spacer");e||((e=document.createElement("div")).classList.add("banner-expertise-spacer"),document.querySelector(".banner-expertise").insertAdjacentElement("afterend",e)),e.style.height=i+"px";n=gsap.utils.toArray(".wrapper-chess .chess-item");gsap.set(n,{y:"120%"});let r=gsap.timeline({scrollTrigger:{trigger:".banner-expertise",start:"top top",end:"+=200%",scrub:!0,pin:!0,pinSpacing:!1}});n.forEach(e=>{r.to(e,{y:"0%",duration:.6,ease:"none"})})}}function buildABrand(){if(!($(".build-a-brand").length<1)){let r=$(".build-a-brand .tab-wrapper .item");r.on("click",function(){var e=$(this),t=e.data("branding");e.hasClass("active")||(r.removeClass("active"),e.addClass("active"),(e=$(".build-a-brand .wrapper-content")).find(".item").addClass("d-none"),e.find(`.item[data-branding="${t}"]`).removeClass("d-none"))}),ScrollTrigger.create({trigger:".build-a-brand",start:"top 30%",end:"bottom top",onEnter:()=>{$(".build-a-brand .tab-wrapper .item[data-branding='2']").addClass("active")},onLeaveBack:()=>{$(".build-a-brand .tab-wrapper .item").removeClass("active")}})}}function introBrading(){if(!(document.querySelectorAll(".build-a-brand").length<1)){let t=new Lenis,r=(t.on("scroll",()=>ScrollTrigger.update()),e=>{t.raf(1e3*e),requestAnimationFrame(r)}),e=(requestAnimationFrame(r),gsap.registerPlugin(ScrollTrigger,SplitText),document.getElementById("intro-branding")),o=e.getContext("2d");e.width=window.innerWidth,e.height=window.innerHeight,window.addEventListener("resize",function(){e.width=window.innerWidth,e.height=window.innerHeight,i()});document.querySelector(".build-a-brand");let s=[],d={frame:0},n=0;for(let t=0;t<74;t++){let e=new Image;e.src=`./assets/images/img-chess/chess-${(t+1).toString()}.jpg`,e.onload=()=>{74===++n&&i()},e.onerror=()=>{console.error("Không tải được hình ảnh: "+e.src)},s[t]=e}function i(){var e,t,r,n,i,a;s[d.frame]&&s[d.frame].complete&&(e=s[d.frame],t=o,r=t.canvas,n=r.width/e.width,i=r.height/e.height,n=Math.max(n,i),i=(r.width-e.width*n)/2,a=(r.height-e.height*n)/2,t.clearRect(0,0,r.width,r.height),t.drawImage(e,0,0,e.width,e.height,i,a,e.width*n,e.height*n))}gsap.to(d,{frame:73,snap:"frame",ease:"none",scrollTrigger:{scrub:1,trigger:"#intro-branding",start:"top bottom",end:"bottom top",markers:!0},onUpdate:i}),gsap.to(".section-intro",{scrollTrigger:{trigger:".section-intro",start:"top top",end:"bottom top",pin:!0,pinSpacing:!1}})}}let init=()=>{gsap.registerPlugin(ScrollTrigger),animateChessItems(),buildABrand(),ScrollTrigger.refresh(),introBrading()};preloadImages("img").then(()=>{init()}),$(window).on("beforeunload",function(){$(window).scrollTop(0)});