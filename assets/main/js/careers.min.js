import{preloadImages}from"../../libs/utils.js";function formReruitment(){var e;$(".our-works").length<1||($(".modal-recruitment .file-attach").on("change",function(){var e,t=this.files[0],r=$(this),a=r.next("label").find("span");r.removeClass("error"),a.text("Upload file under 5MB"),t&&(["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(t.type)?5242880<t.size?(r.addClass("error"),a.text("File too large (max 5MB)"),r.val("")):(t=t.name,e=28,t=(e=(e=t.length>e?t.slice(0,e)+"...":t).toLowerCase()).charAt(0).toUpperCase()+e.slice(1),a.text(t),a.addClass("has-file")):(r.addClass("error"),a.text("Only PDF or DOCX files allowed"),r.val("")))}),$("form.form-recruitment").on("submit",function(e){e.preventDefault();let a=$(this);var e=a.find("input[name='name']"),t=a.find("input[name='email']");let r=a.find("input[type='file']");var n=a.find("input[name='cv']");let o=a.find(".note"),i=a.find(".success-message"),l=a.find("button[type='submit']");var s,d=l.attr("job-id");let m=!0;a.find("input").removeClass("error"),""===e.val().trim()&&(e.addClass("error"),m=!1),""===t.val().trim()&&(t.addClass("error"),m=!1),0===r.get(0).files.length&&(r.addClass("error"),m=!1),m&&((s=new FormData).append("action","submit_recruitment_form"),s.append("name",e.val().trim()),s.append("email",t.val().trim()),s.append("cv",n.val().trim()),s.append("file",r.get(0).files[0]),s.append("job_id",d),console.log(r.get(0).files[0]),$.ajax({url:ajaxUrl,type:"POST",data:s,processData:!1,contentType:!1,beforeSend:function(){l.addClass("aloading")},success:function(e){a[0].reset(),a.find("input[type='file']").next("label").find("span").text("Upload file under 5MB").removeClass("has-file"),0<o.length&&0<i.length&&(o.hide(),i.show(),setTimeout(function(){o.show(),i.hide()},5e3)),r.removeClass("error"),l.removeClass("aloading")},error:function(e,t,r){console.error("Lỗi khi gửi form:",r),a.append('<span class="contact-message body-sm-regular" style="color: #FF0000;">Có lỗi xảy ra, vui lòng thử lại sau.</span>'),l.removeClass("aloading")}}))}),e=991<window.innerWidth?"top 65%":"top 40%",ScrollTrigger.create({trigger:".our-works",start:e,onEnter:()=>{document.querySelector(".our-works").classList.add("theme-light"),document.querySelector(".header-menu-container").classList.add("theme-light"),document.querySelector("main").classList.add("theme-light"),document.querySelector(".section-banner").classList.add("theme-light")},onLeaveBack:()=>{document.querySelector(".our-works").classList.remove("theme-light"),document.querySelector(".header-menu-container").classList.remove("theme-light"),document.querySelector("main").classList.remove("theme-light"),document.querySelector(".section-banner").classList.remove("theme-light")}}))}let init=()=>{gsap.registerPlugin(ScrollTrigger),formReruitment(),ScrollTrigger.refresh()};preloadImages("img").then(()=>{init()}),$(window).on("beforeunload",function(){$(window).scrollTop(0)});